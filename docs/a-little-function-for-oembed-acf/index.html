<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="jimmy.smutek">
<meta name="description" content="We&amp;rsquo;ve been doing a lot of videos on our sites lately. Well, we&amp;rsquo;ve always done a lot of videos on our sites. The model is usually an on-page embed, either directly in page or via a modal, and we set the back-end up to use the oEmbed field in Advanced Custom Fields Pro. It gives a great back-end experience - and why use WordPress if it&amp;rsquo;s not going to be user configurable, right?" />
<meta name="keywords" content=", acf, php, snippets" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#252627" />
<link rel="canonical" href="https://smutek.net/a-little-function-for-oembed-acf/" />


    <title>
        
            A little function for oEmbed &#43; ACF :: smutek.net  â€” Hello Friend NG Theme
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://smutek.net/main.d1ea4af8fd04fb24a4f8b882ea54bd04eb245427ca4baf527c81a5dab071410b.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://smutek.net/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://smutek.net/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://smutek.net/favicon-16x16.png">
    <link rel="manifest" href="https://smutek.net/site.webmanifest">
    <link rel="mask-icon" href="https://smutek.net/safari-pinned-tab.svg" color="#252627">
    <link rel="shortcut icon" href="https://smutek.net/favicon.ico">
    <meta name="msapplication-TileColor" content="#252627">
    <meta name="theme-color" content="#252627">



<meta itemprop="name" content="A little function for oEmbed &#43; ACF">
<meta itemprop="description" content="We&rsquo;ve been doing a lot of videos on our sites lately. Well, we&rsquo;ve always done a lot of videos on our sites. The model is usually an on-page embed, either directly in page or via a modal, and we set the back-end up to use the oEmbed field in Advanced Custom Fields Pro. It gives a great back-end experience - and why use WordPress if it&rsquo;s not going to be user configurable, right?">
<meta itemprop="datePublished" content="2016-09-10T02:18:39+00:00" />
<meta itemprop="dateModified" content="2016-09-10T02:18:39+00:00" />
<meta itemprop="wordCount" content="334">
<meta itemprop="image" content="https://smutek.net"/>



<meta itemprop="keywords" content="acf,php,snippets," />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://smutek.net"/>

<meta name="twitter:title" content="A little function for oEmbed &#43; ACF"/>
<meta name="twitter:description" content="We&rsquo;ve been doing a lot of videos on our sites lately. Well, we&rsquo;ve always done a lot of videos on our sites. The model is usually an on-page embed, either directly in page or via a modal, and we set the back-end up to use the oEmbed field in Advanced Custom Fields Pro. It gives a great back-end experience - and why use WordPress if it&rsquo;s not going to be user configurable, right?"/>



    <meta property="og:title" content="A little function for oEmbed &#43; ACF" />
<meta property="og:description" content="We&rsquo;ve been doing a lot of videos on our sites lately. Well, we&rsquo;ve always done a lot of videos on our sites. The model is usually an on-page embed, either directly in page or via a modal, and we set the back-end up to use the oEmbed field in Advanced Custom Fields Pro. It gives a great back-end experience - and why use WordPress if it&rsquo;s not going to be user configurable, right?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://smutek.net/a-little-function-for-oembed-acf/" />
<meta property="og:image" content="https://smutek.net"/>
<meta property="article:published_time" content="2016-09-10T02:18:39+00:00" />
<meta property="article:modified_time" content="2016-09-10T02:18:39+00:00" />




    <meta property="article:section" content="WordPress" />



    <meta property="article:published_time" content="2016-09-10 02:18:39 &#43;0000 &#43;0000" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://smutek.net/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">My Interwebs Blog</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://smutek.net/about-me/">About</a></li><li><a href="https://smutek.net/contact/">Contact</a></li><li><a href="https://smutek.net/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://smutek.net/a-little-function-for-oembed-acf/">A little function for oEmbed + ACF</a></h2>

            

            <div class="post-content">
                <p>We&rsquo;ve been doing a lot of videos on our sites lately. Well, we&rsquo;ve always done a lot of videos on our sites. The model is usually an on-page embed, either directly in page or via a modal, and we set the back-end up to use the oEmbed field in Advanced Custom Fields Pro. It gives a great back-end experience - and why use WordPress if it&rsquo;s not going to be user configurable, right?</p>
<p>Anyway, in almost every case we need to disable the display of related videos. The <a href="https://www.advancedcustomfields.com/resources/oembed/">problem has already been solved</a>, but I&rsquo;m doing this often enough that I wrote this simple, but handy little function to take care of it. Configure the parameters in the function itself, and just pass it your field name. Outputs the URL and everything in the <em>$params</em> array gets passed in on the tail end as a query string.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#e6db74">/**
</span><span style="color:#e6db74"> * oEmbed Attributes
</span><span style="color:#e6db74"> *
</span><span style="color:#e6db74"> * Add parameters to oEmbed query string. Useful for
</span><span style="color:#e6db74"> * turning off related videos and such.
</span><span style="color:#e6db74"> *
</span><span style="color:#e6db74"> * Basic field use: $video = videoLink(&#39;your_field_name&#39;);
</span><span style="color:#e6db74"> * Add second param if in a repeater: $video - videoLink(&#39;your_subfield_name&#39;, true);
</span><span style="color:#e6db74"> *
</span><span style="color:#e6db74"> * @see https://www.advancedcustomfields.com/resources/oembed/
</span><span style="color:#e6db74"> *
</span><span style="color:#e6db74"> * @param $field
</span><span style="color:#e6db74"> * @param bool $repeater defaults to false / true if repeater
</span><span style="color:#e6db74"> * @return mixed  embed HTML
</span><span style="color:#e6db74"> */</span>
<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">videoLink</span>($field, $repeater <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>) {

  <span style="color:#66d9ef">global</span> $post;

  <span style="color:#75715e">// get current post ID
</span><span style="color:#75715e"></span>  $id <span style="color:#f92672">=</span> $post<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">ID</span>;

  <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span>$repeater) {
    <span style="color:#75715e">// get the field
</span><span style="color:#75715e"></span>    $videoFrame  <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_field</span>( $field, $id );
  } <span style="color:#66d9ef">else</span> {
    <span style="color:#75715e">// if we are in a repeater
</span><span style="color:#75715e"></span>    $videoFrame  <span style="color:#f92672">=</span> <span style="color:#a6e22e">get_sub_field</span>( $field, $id );
  }

  <span style="color:#75715e">// use preg_match to find iframe src
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">preg_match</span>(<span style="color:#e6db74">&#39;/src=&#34;(.+?)&#34;/&#39;</span>, $videoFrame, $matches);
  $src <span style="color:#f92672">=</span> $matches[<span style="color:#ae81ff">1</span>];

  <span style="color:#75715e">// add extra params to iframe src
</span><span style="color:#75715e"></span>  $params <span style="color:#f92672">=</span> <span style="color:#66d9ef">array</span>(
    <span style="color:#e6db74">&#39;rel&#39;</span>    <span style="color:#f92672">=&gt;</span> <span style="color:#ae81ff">0</span>
  );

  $new_src <span style="color:#f92672">=</span> <span style="color:#a6e22e">add_query_arg</span>($params, $src);
  $videoLink <span style="color:#f92672">=</span> <span style="color:#a6e22e">str_replace</span>($src, $new_src, $videoFrame);

  <span style="color:#66d9ef">return</span> $videoLink;

}
</code></pre></div>
<p>To use it somewhere just pass it your field name. So, if your ACF field is <em>my_video</em>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#66d9ef">echo</span> <span style="color:#a6e22e">videoLink</span>(<span style="color:#e6db74">&#39;my_video&#39;</span>);
</code></pre></div>
<p>If you&rsquo;re rolling with a repeater, just set the second parameter to true.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#66d9ef">echo</span> <span style="color:#a6e22e">videoLink</span>(<span style="color:#e6db74">&#39;my_video&#39;</span>, <span style="color:#66d9ef">true</span>);
</code></pre></div>
<p><a href="https://gist.github.com/smutek/f11531a44327761c9cb7b660a9a78b95">GitHub Gist</a></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  				<p>
  					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://smutek.net/tags/acf">acf</a></span><span class="tag"><a href="https://smutek.net/tags/php">php</a></span><span class="tag"><a href="https://smutek.net/tags/snippets">snippets</a></span>
  				</p>
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
                <span><a href="https://smutek.net">Jimmy Smutek</a></span>
            
            
                <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            
            <span> <a href="https://smutek.net/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
        </div>
    </div>
</footer>
            
        </div>

        




<script type="text/javascript" src="https://smutek.net/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>



    </body>
</html>
